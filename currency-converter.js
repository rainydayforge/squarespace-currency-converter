document.addEventListener("DOMContentLoaded",function(){const e="CAD",t={CA:"CAD",US:"USD"},n="https://open.er-api.com/v6/latest/CAD",c="https://ipwho.is/",r={CAD:"C$",USD:"$"};async function a(){try{const e=await fetch(c),t=await e.json();return t&&t.country_code?t.country_code:"CA"}catch(e){return console.error("Geo API failed:",e),"CA"}}async function s(){try{const e=localStorage.getItem("exchangeRates"),t=localStorage.getItem("exchangeRatesTime"),c=864e5;if(e&&t&&Date.now()-t<c)return JSON.parse(e);const r=await fetch(n),a=await r.json();return localStorage.setItem("exchangeRates",JSON.stringify(a.rates)),localStorage.setItem("exchangeRatesTime",Date.now()),a.rates}catch(e){return console.error("Exchange API failed:",e),null}}function o(e,n){[".sqs-money-native",".ProductItem-details .ProductItem-price",".price",".ProductItem-price .sqs-money-element",".CartItem-price",".OrderSummary-price",".SummaryItem-price",".ProductList-price",".ProductItem-price-regular",".product-price"].forEach((function(c){document.querySelectorAll(c).forEach((function(a){if(!a.getAttribute("data-converted")){const s=a.textContent.replace(/[^0-9.]/g,""),o=parseFloat(s);if(!isNaN(o)){let t=o*e;t=Math.round(t)-.01,t=t.toFixed(2),a.textContent=`${r[n]}${t} ${n}`,a.setAttribute("data-converted","true")}}}))}))}!async function(){const c=await a(),r=t[c]||e;if(r===e)return;const i=await s();if(!i||!i[r])return;const d=i[r],l=new MutationObserver((()=>{o(d,r)}));l.observe(document.body,{childList:!0,subtree:!0}),o(d,r)}()});
